var Modal=function(){var t=$(".modal__trigger"),e=$(".modal"),n=$(".modal__dialog"),o=$(".modal__bg"),i=$(".modal__content"),a=$(".close-btn"),s=window,l=!1,d=400,r=(t.length,function(t){t.preventDefault();var e=this,n=e.dataset.modal,o=n.length,i=n.substring(1,o),a=document.getElementById(i);c(e,a)}),c=function(t,e){var n=document.getElementById("modal__temp");if(null===n){var o=document.createElement("div");o.id="modal__temp",t.appendChild(o),m(t,e,o)}},m=function(t,e,n){var o,i,a,l,r=t.getBoundingClientRect(),c=e,m=c.querySelector(".modal__content").getBoundingClientRect(),g=s.innerWidth/2,f=s.innerHeight/2;t.classList.add("modal__trigger--active"),a=m.width/r.width,l=m.height/r.height,a=a.toFixed(3),l=l.toFixed(3),o=Math.round(g-r.left-r.width/2),i=Math.round(f-r.top-r.height/2),c.classList.contains("modal--align-top")&&(i=Math.round(m.height/2+m.top-r.top-r.height/2)),t.style.transform="translate("+o+"px, "+i+"px)",t.style.webkitTransform="translate("+o+"px, "+i+"px)",n.style.transform="scale("+a+","+l+")",n.style.webkitTransform="scale("+a+","+l+")",window.setTimeout(function(){window.requestAnimationFrame(function(){u(c,n)})},d)},u=function(t,o){function i(){o.style.opacity="0",a.removeEventListener("transitionend",i,!1)}if(!l){var a=t.querySelector(".modal__content");t.classList.add("modal--active"),a.classList.add("modal__content--active"),$("body").hasClass("mobile")&&e.on("focus","input",function(){n.addClass("key-on")}).on("blur","input",function(){n.removeClass("key-on")}),a.addEventListener("transitionend",i,!1),l=!0,window.setTimeout(function(){e.siblings("div, header, footer, main").addClass("blurred")},50)}},g=function(n){function o(){setTimeout(function(){window.requestAnimationFrame(function(){s.remove()})},d-50)}n.preventDefault(),n.stopImmediatePropagation();var a=n.target,s=document.getElementById("modal__temp");(l&&a.classList.contains("modal__bg")||a.classList.contains("close-btn"))&&(s.style.opacity="1",s.removeAttribute("style"),e.removeClass("modal--active"),i.removeClass("modal__content--active"),t.css("transform","none").removeClass("modal__trigger--active"),s.addEventListener("transitionend",o,!1),l=!1,e.siblings().removeClass("blurred"))},f=function(){t.on("click",r),a.on("click",g),o.on("click",g)},v=function(){f()};return{init:v}}();Modal.init();